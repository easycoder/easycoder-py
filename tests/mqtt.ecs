!   mqtt.ecs

    script MQTTTest

    use mqtt

    topic Request
    topic Response
    variable Message
    
    init Request
        name `a8:41:f4:d3:19:dd/request`
        qos 1
    init Response
        name `a8:41:f4:d3:19:dd/response`
        qos 1

    mqtt
        id `EasyCoder-MQTT-Test`
        broker `test.mosquitto.org`
        port 1883
        topics Response
    
    on mqtt message
        begin
            put the mqtt message into Message
            log `Message received`
!            log Message
        end

    wait 3
    
    log `Request a file`
    send mqtt `file:/home/graham/dev/easycoder/easycoder-py/tests/tests.ecs` to Request

    wait 3

    exit
